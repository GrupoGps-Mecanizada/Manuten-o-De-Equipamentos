<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>GrupoGPS Mecanizada - Sistema de Dupla Checagem de Manuten√ß√£o</title>

  <!-- Favicon -->
  <link rel="icon" href="data:,">

  <!-- Chart.js para gr√°ficos -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>

  <!-- Estilos CSS -->
  <link rel="stylesheet" href="css/styles.css">

  <!-- JavaScript principal ser√° carregado no final do body -->
</head>

<body>
  <div class="container">
    <div class="header">
      <div class="company-branding">
        <a href="#" class="company-logo">GrupoGPS - Mecanizada</a>
        <span class="notification-badge">Manuten√ß√£o</span>
      </div>
      <h1>Sistema de Dupla Checagem de Manuten√ß√£o</h1>
      <p>Registro, verifica√ß√£o e controle de manuten√ß√µes</p>
    </div>

    <div class="tabs">
      <div class="tab active" data-tab="dashboard">Dashboard</div>
      <div class="tab" data-tab="maintenance">Manuten√ß√µes</div>
      <div class="tab" data-tab="verification">Verifica√ß√µes</div>
      <div class="tab" data-tab="reports">Relat√≥rios</div>
    </div>

    <!-- Dashboard Tab -->
    <div class="tab-content active" id="tab-dashboard">
      <div class="dashboard-header">
        <h2>Vis√£o Geral</h2>
        <div class="date-filter">
          <label for="period-filter">Per√≠odo:</label>
          <select id="period-filter">
            <option value="all">Todos</option>
            <option value="current-month" selected>M√™s Atual</option>
            <option value="last-month">M√™s Anterior</option>
            <option value="last-3-months">√öltimos 3 Meses</option>
            <option value="last-6-months">√öltimos 6 Meses</option>
            <option value="current-year">Ano Atual</option>
          </select>
        </div>
      </div>

      <!-- Resumo em cards -->
      <div class="summary-cards">
        <div class="card">
          <div class="card-title">
            <i class="icon">üîß</i>
            Total de Manuten√ß√µes
          </div>
          <div class="card-value" id="total-maintenance">0</div>
          <div class="card-footer">
            <span>Per√≠odo selecionado</span>
          </div>
        </div>

        <div class="card">
          <div class="card-title">
            <i class="icon">‚åõ</i>
            Aguardando Verifica√ß√£o
          </div>
          <div class="card-value" id="pending-verification">0</div>
          <div class="card-footer">
            <span>Precisa de aten√ß√£o</span>
          </div>
        </div>

        <div class="card">
          <div class="card-title">
            <i class="icon">‚úÖ</i>
            Verifica√ß√µes Conclu√≠das
          </div>
          <div class="card-value" id="completed-verifications">0</div>
          <div class="card-footer">
            <span>Per√≠odo atual</span>
            <span class="card-trend trend-up" id="verification-trend">+0.0%</span>
          </div>
        </div>

        <div class="card">
          <div class="card-title">
            <i class="icon">‚ö†Ô∏è</i>
            Manuten√ß√µes Cr√≠ticas
          </div>
          <div class="card-value" id="critical-maintenance">0</div>
          <div class="card-footer">
            <span>Aten√ß√£o necess√°ria</span>
          </div>
        </div>
      </div>

      <!-- Gr√°ficos B√°sicos -->
      <div class="grid-container">
        <div class="section">
          <h3 class="section-title">
            Manuten√ß√µes por Tipo
            <div class="section-actions">
              <button class="btn-icon" id="refresh-type-chart" title="Atualizar">‚Üª</button>
            </div>
          </h3>
          <div class="chart-container">
            <canvas id="maintenance-type-chart"></canvas>
          </div>
        </div>

        <div class="section">
          <h3 class="section-title">
            Status das Manuten√ß√µes
            <div class="section-actions">
              <button class="btn-icon" id="refresh-status-chart" title="Atualizar">‚Üª</button>
            </div>
          </h3>
          <div class="chart-container">
            <canvas id="maintenance-status-chart"></canvas>
          </div>
        </div>
      </div>

      <!-- Gr√°ficos Avan√ßados -->
      <div class="section">
        <h3 class="section-title">An√°lises Avan√ßadas</h3>

        <div class="grid-container">
          <!-- Altera√ß√£o 1: Mudar "Distribui√ß√£o por √Årea" para "Local de Manuten√ß√£o" (J√° estava correto no HTML original fornecido) -->
          <div class="section sub-section">
            <h4 class="section-title">
              Local de Manuten√ß√£o
              <div class="section-actions">
                <button class="btn-icon" id="refresh-area-chart" title="Atualizar">‚Üª</button>
              </div>
            </h4>
            <div class="chart-container">
              <canvas id="area-distribution-chart"></canvas>
            </div>
          </div>

          <!-- Categorias de Problemas -->
          <div class="section sub-section">
            <h4 class="section-title">
              Categorias de Problemas
              <div class="section-actions">
                <button class="btn-icon" id="refresh-problem-chart" title="Atualizar">‚Üª</button>
              </div>
            </h4>
            <div class="chart-container">
              <canvas id="problem-categories-chart"></canvas>
            </div>
          </div>
        </div>

        <div class="grid-container">
          <!-- Tend√™ncia Mensal -->
          <div class="section sub-section">
            <h4 class="section-title">
              Tend√™ncia Mensal
              <div class="section-actions">
                <button class="btn-icon" id="refresh-trend-chart" title="Atualizar">‚Üª</button>
              </div>
            </h4>
            <div class="chart-container">
              <canvas id="monthly-trend-chart"></canvas>
            </div>
          </div>

          <!-- Cr√≠ticas vs Regulares -->
          <div class="section sub-section">
            <h4 class="section-title">
              Manuten√ß√µes Cr√≠ticas vs Regulares
              <div class="section-actions">
                <button class="btn-icon" id="refresh-critical-chart" title="Atualizar">‚Üª</button>
              </div>
            </h4>
            <div class="chart-container">
              <canvas id="critical-vs-regular-chart"></canvas>
            </div>
          </div>
        </div>

        <div class="grid-container">
          <!-- Resultados das Verifica√ß√µes -->
          <div class="section sub-section">
            <h4 class="section-title">
              Resultados das Verifica√ß√µes
              <div class="section-actions">
                <button class="btn-icon" id="refresh-verification-chart" title="Atualizar">‚Üª</button>
              </div>
            </h4>
            <div class="chart-container">
              <canvas id="verification-results-chart"></canvas>
            </div>
          </div>

          <!-- Frequ√™ncia de Manuten√ß√µes -->
          <div class="section sub-section">
            <h4 class="section-title">
              Intervalo entre Manuten√ß√µes
              <div class="section-actions">
                <button class="btn-icon" id="refresh-frequency-chart" title="Atualizar">‚Üª</button>
              </div>
            </h4>
            <div class="chart-container">
              <canvas id="maintenance-frequency-chart"></canvas>
            </div>
          </div>
        </div>
      </div>

      <!-- Equipamentos com mais manuten√ß√µes -->
      <div class="section">
        <h3 class="section-title">
          Equipamentos com Mais Manuten√ß√µes
          <div class="section-actions">
            <button class="btn-icon" id="refresh-equipment-ranking" title="Atualizar">‚Üª</button>
          </div>
        </h3>
        <div class="table-responsive">
          <table id="equipment-ranking-table">
            <thead>
              <tr>
                <th>Equipamento</th>
                <th>Tipo</th>
                <th>Total Manuten√ß√µes</th>
                <th>√öltima Manuten√ß√£o</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody id="equipment-ranking-tbody">
              <!-- Dados ser√£o preenchidos via JavaScript -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- Manuten√ß√µes Recentes -->
      <div class="section">
        <h3 class="section-title">Manuten√ß√µes Recentes</h3>
        <div class="table-responsive">
          <table id="recent-maintenance-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Equipamento</th>
                <th>Tipo</th>
                <th>Data Registro</th>
                <th>Respons√°vel</th>
                <th>Status</th>
                <th>A√ß√µes</th>
              </tr>
            </thead>
            <tbody id="recent-maintenance-tbody">
              <!-- Dados ser√£o preenchidos via JavaScript -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Manuten√ß√µes Tab -->
    <div class="tab-content" id="tab-maintenance">
      <div class="section">
        <div class="search-container">
          <input type="text" class="search-input" id="maintenance-search" placeholder="Buscar por ID, equipamento, respons√°vel...">
        </div>

        <div class="filter-container">
          <div class="filter-item active" data-filter="all">Todos</div>
          <div class="filter-item" data-filter="pending">Aguardando Verifica√ß√£o</div>
          <div class="filter-item" data-filter="verified">Verificados</div>
          <div class="filter-item" data-filter="completed">Conclu√≠dos</div>
          <div class="filter-item" data-filter="critical">Cr√≠ticos</div>
        </div>

        <h3 class="section-title">
          Lista de Manuten√ß√µes
          <div class="section-actions">
            <button class="btn-icon" id="refresh-maintenance-list" title="Atualizar">‚Üª</button>
          </div>
        </h3>

        <div class="table-responsive">
          <table id="maintenance-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Equipamento</th>
                <th>Tipo</th>
                <th>Data Registro</th>
                <th>Respons√°vel</th>
                <th>√Årea</th>
                <th>Local/Oficina</th>
                <th>Problema</th>
                <th>Status</th>
                <th>A√ß√µes</th>
              </tr>
            </thead>
            <tbody id="maintenance-tbody">
              <!-- Dados ser√£o preenchidos via JavaScript -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Verifica√ß√µes Tab -->
    <div class="tab-content" id="tab-verification">
      <div class="section">
        <div class="search-container">
          <input type="text" class="search-input" id="verification-search" placeholder="Buscar por ID, equipamento, respons√°vel...">
        </div>

        <div class="filter-container">
          <div class="filter-item active" data-filter="all">Todos</div>
          <div class="filter-item" data-filter="pending">Aguardando Verifica√ß√£o</div>
          <div class="filter-item" data-filter="verified">Verificados Hoje</div>
          <div class="filter-item" data-filter="completed">Conclu√≠dos</div>
        </div>

        <h3 class="section-title">
          Verifica√ß√µes Pendentes
          <div class="section-actions">
            <button class="btn-icon" id="refresh-verification-list" title="Atualizar">‚Üª</button>
          </div>
        </h3>

        <div class="table-responsive">
          <table id="verification-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Equipamento</th>
                <th>Tipo</th>
                <th>Data Manuten√ß√£o</th>
                <th>Respons√°vel</th>
                <th>√Årea</th>
                <th>Local/Oficina</th>
                <th>Status</th>
                <th>A√ß√µes</th>
              </tr>
            </thead>
            <tbody id="verification-tbody">
              <!-- Dados ser√£o preenchidos via JavaScript -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Relat√≥rios Tab -->
    <div class="tab-content" id="tab-reports">
      <div class="section">
        <h3 class="section-title">Relat√≥rios por Per√≠odo</h3>
        <div class="form-row">
          <div class="form-col">
            <div class="form-group">
              <label for="report-start-date">Data Inicial</label>
              <input type="date" class="form-control" id="report-start-date">
            </div>
          </div>
          <div class="form-col">
            <div class="form-group">
              <label for="report-end-date">Data Final</label>
              <input type="date" class="form-control" id="report-end-date">
            </div>
          </div>
          <div class="form-col" style="display: flex; align-items: flex-end;">
            <button class="btn" id="generate-report">Gerar Relat√≥rio</button>
          </div>
        </div>
      </div>

      <div id="report-content" style="display: none;">
        <div class="section">
          <h3 class="section-title">Resumo do Per√≠odo</h3>
          <div class="summary-cards">
            <div class="card">
              <div class="card-title">Total de Manuten√ß√µes</div>
              <div class="card-value" id="report-total">0</div>
            </div>
            <div class="card">
              <div class="card-title">Conclu√≠das</div>
              <div class="card-value" id="report-completed">0</div>
            </div>
            <div class="card">
              <div class="card-title">Pendentes</div>
              <div class="card-value" id="report-pending">0</div>
            </div>
            <div class="card">
              <div class="card-title">Verificadas</div>
              <div class="card-value" id="report-verified">0</div>
            </div>
          </div>
        </div>

        <div class="section">
          <h3 class="section-title">An√°lise por Categoria de Problema</h3>
          <div class="chart-container">
            <canvas id="report-problem-chart"></canvas>
          </div>
        </div>

        <div class="grid-container">
          <div class="section">
            <h3 class="section-title">Distribui√ß√£o por √Årea</h3>
            <div class="chart-container">
              <canvas id="report-area-chart"></canvas>
            </div>
          </div>

          <div class="section">
            <h3 class="section-title">Manuten√ß√µes por M√™s</h3>
            <div class="chart-container">
              <canvas id="report-monthly-chart"></canvas>
            </div>
          </div>
        </div>

        <div class="section">
          <h3 class="section-title">Exportar Dados</h3>
          <div class="btn-action-group">
            <button class="btn" id="export-excel">Exportar para Excel</button>
            <button class="btn" id="export-pdf">Exportar para PDF</button>
            <button class="btn" id="print-report">Imprimir Relat√≥rio</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Formul√°rio de Nova Manuten√ß√£o -->
    <div class="form-overlay" id="maintenance-form-overlay">
      <div class="form-container">
        <div class="form-header">
          <h2 class="form-title">Registrar Nova Manuten√ß√£o</h2>
          <button class="form-close" id="close-maintenance-form">√ó</button>
        </div>

        <div class="form-steps">
          <div class="form-step active" data-step="1">
            <div class="step-number">1</div>
            <div class="step-label">Informa√ß√µes</div>
          </div>
          <div class="form-step" data-step="2">
            <div class="step-number">2</div>
            <div class="step-label">Problema</div>
          </div>
          <div class="form-step" data-step="3">
            <div class="step-number">3</div>
            <div class="step-label">Confirmar</div>
          </div>
        </div>

        <form id="maintenance-form">
          <!-- Etapa 1: Informa√ß√µes B√°sicas -->
          <div class="form-step-content" id="step-1-content">
            <div class="form-row">
              <div class="form-col">
                <div class="form-group">
                  <label for="equipment-type">Tipo de Equipamento <span class="form-required">*</span></label>
                  <select class="form-control" id="equipment-type" name="equipment-type" required>
                    <option value="">Selecione o tipo...</option>
                    <!-- Op√ß√µes ser√£o preenchidas via JavaScript -->
                  </select>
                </div>
              </div>
              <div class="form-col">
                <div class="form-group">
                  <label for="equipment-id">Placa ou ID <span class="form-required">*</span></label>
                  <select class="form-control" id="equipment-id" name="equipment-id" required>
                    <option value="">Selecione o equipamento...</option>
                    <!-- Op√ß√µes ser√£o preenchidas via JavaScript -->
                  </select>
                </div>
              </div>
            </div>

            <!-- Campo para "Outro Equipamento" -->
            <div class="form-group" id="other-equipment-field" style="display:none;">
              <label for="other-equipment">Especifique Equipamento <span class="form-required">*</span></label>
              <input type="text" class="form-control" id="other-equipment" name="other-equipment">
            </div>

            <!-- Campo para ID de Aspirador/Poliguindaste ser√° inserido aqui pelo JS -->

            <div class="form-row">
              <div class="form-col">
                <div class="form-group">
                  <label for="technician-name">Respons√°vel pelo Relat√≥rio <span class="form-required">*</span></label>
                  <input type="text" class="form-control" id="technician-name" name="technician-name" required>
                </div>
              </div>
              <div class="form-col">
                <div class="form-group">
                  <label for="maintenance-date">Data da Manuten√ß√£o <span class="form-required">*</span></label>
                  <input type="date" class="form-control" id="maintenance-date" name="maintenance-date" required>
                </div>
              </div>
            </div>

            <div class="form-row">
              <div class="form-col">
                <div class="form-group">
                  <label for="area">√Årea <span class="form-required">*</span></label>
                  <select class="form-control" id="area" name="area" required>
                    <option value="">Selecione...</option>
                    <option value="√Årea Interna Usiminas">√Årea Interna Usiminas</option>
                    <option value="√Årea Externa Usiminas">√Årea Externa Usiminas</option>
                  </select>
                </div>
              </div>
              <div class="form-col">
                <div class="form-group" id="office-field">
                  <label for="office">Local/Oficina <span class="form-required">*</span></label>
                  <input type="text" class="form-control" id="office" name="office" required>
                </div>
              </div>
            </div>

            <div class="form-row">
              <div class="form-col">
                <div class="form-group">
                  <label for="maintenance-type">Tipo de Manuten√ß√£o <span class="form-required">*</span></label>
                  <select class="form-control" id="maintenance-type" name="maintenance-type" required>
                    <option value="">Selecione o tipo...</option>
                    <option value="Preventiva">Preventiva</option>
                    <option value="Corretiva">Corretiva</option>
                    <option value="Emergencial">Emergencial</option>
                  </select>
                </div>
              </div>
              <div class="form-col">
                <div class="form-group">
                  <div class="form-check" style="padding-top: 30px;">
                    <input type="checkbox" id="is-critical" name="is-critical">
                    <label for="is-critical">Manuten√ß√£o Cr√≠tica (requer aten√ß√£o imediata)</label>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-navigation">
              <button type="button" class="btn" id="cancel-maintenance">Cancelar</button>
              <button type="button" class="btn btn-success" id="next-to-step-2">Pr√≥ximo</button>
            </div>
          </div>

          <!-- Etapa 2: Problema -->
          <div class="form-step-content" id="step-2-content" style="display: none;">
            <div class="form-group">
              <label for="problem-category">Categoria do Problema <span class="form-required">*</span></label>
              <select class="form-control" id="problem-category" name="problem-category" required>
                <option value="">Selecione a categoria...</option>
                <!-- Op√ß√µes ser√£o preenchidas via JavaScript -->
              </select>
            </div>

            <!-- Campo para "Outra Categoria" -->
            <div class="form-group" id="other-category-field" style="display:none;">
              <label for="other-category">Especifique Categoria <span class="form-required">*</span></label>
              <input type="text" class="form-control" id="other-category" name="other-category">
            </div>

            <div class="form-group">
              <label for="problem-description">Detalhes do Problema <span class="form-required">*</span></label>
              <textarea class="form-control" id="problem-description" name="problem-description" rows="4" required></textarea>
            </div>

            <div class="form-group">
              <label for="additional-notes">Observa√ß√µes Adicionais</label>
              <textarea class="form-control" id="additional-notes" name="additional-notes" rows="3"></textarea>
            </div>

            <div class="form-navigation">
              <button type="button" class="btn" id="back-to-step-1">Voltar</button>
              <button type="button" class="btn btn-success" id="next-to-step-3">Pr√≥ximo</button>
            </div>
          </div>

          <!-- Etapa 3: Revis√£o e Confirma√ß√£o -->
          <div class="form-step-content" id="step-3-content" style="display: none;">
            <div class="form-group">
              <h3>Resumo da Manuten√ß√£o</h3>
              <div class="summary-content">
                <div class="summary-row">
                  <div class="summary-label">Equipamento:</div>
                  <div class="summary-value" id="summary-equipment"></div>
                </div>
                <div class="summary-row">
                  <div class="summary-label">Respons√°vel:</div>
                  <div class="summary-value" id="summary-technician"></div>
                </div>
                <div class="summary-row">
                  <div class="summary-label">Data:</div>
                  <div class="summary-value" id="summary-date"></div>
                </div>
                <div class="summary-row">
                  <div class="summary-label">Local:</div>
                  <div class="summary-value" id="summary-location"></div>
                </div>
                <div class="summary-row">
                  <div class="summary-label">Tipo:</div>
                  <div class="summary-value" id="summary-type"></div>
                </div>
                <div class="summary-row">
                  <div class="summary-label">√â Cr√≠tica:</div>
                  <div class="summary-value" id="summary-critical"></div>
                </div>
                <div class="summary-row">
                  <div class="summary-label">Categoria de Problema:</div>
                  <div class="summary-value" id="summary-category"></div>
                </div>
                <div class="summary-row">
                  <div class="summary-label">Detalhes do Problema:</div>
                  <div class="summary-value" id="summary-problem"></div>
                </div>
                <div class="summary-row">
                  <div class="summary-label">Observa√ß√µes:</div>
                  <div class="summary-value" id="summary-notes"></div>
                </div>
              </div>
            </div>

            <div class="form-navigation">
              <button type="button" class="btn" id="back-to-step-2">Voltar</button>
              <button type="submit" class="btn btn-success" id="submit-maintenance">Finalizar Registro</button>
            </div>
          </div>
        </form>
      </div>
    </div>

    <!-- Formul√°rio de Verifica√ß√£o de Manuten√ß√£o -->
    <div class="form-overlay" id="verification-form-overlay">
      <div class="form-container">
        <div class="form-header">
          <h2 class="form-title">Verifica√ß√£o de Manuten√ß√£o</h2>
          <button class="form-close" id="close-verification-form">√ó</button>
        </div>

        <form id="verification-form">
          <div class="form-group">
            <label for="verification-id">ID da Manuten√ß√£o</label>
            <input type="text" class="form-control" id="verification-id" name="verification-id" readonly>
          </div>

          <div class="form-row">
            <div class="form-col">
              <div class="form-group">
                <label for="verification-equipment">Equipamento</label>
                <input type="text" class="form-control" id="verification-equipment" readonly>
              </div>
            </div>
            <div class="form-col">
              <div class="form-group">
                <label for="verification-type">Tipo de Manuten√ß√£o</label>
                <input type="text" class="form-control" id="verification-type" readonly>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label for="verifier-name">Nome do Verificador <span class="form-required">*</span></label>
            <input type="text" class="form-control" id="verifier-name" name="verifier-name" required>
          </div>

          <div class="form-group">
            <label>Resultado da Verifica√ß√£o <span class="form-required">*</span></label>
            <div class="form-check">
              <input type="radio" id="verification-approved" name="verification-result" value="Aprovado" required>
              <label for="verification-approved">Aprovado - Manuten√ß√£o Correta</label>
            </div>
            <div class="form-check">
              <input type="radio" id="verification-adjustments" name="verification-result" value="Ajustes" required>
              <label for="verification-adjustments">Necessita Ajustes Menores</label>
            </div>
            <div class="form-check">
              <input type="radio" id="verification-rejected" name="verification-result" value="Reprovado" required>
              <label for="verification-rejected">Reprovado - Precisa de Nova Manuten√ß√£o</label>
            </div>
          </div>

          <div class="form-group">
            <label for="verification-comments">Coment√°rios da Verifica√ß√£o <span class="form-required">*</span></label>
            <textarea class="form-control" id="verification-comments" name="verification-comments" rows="4" required></textarea>
          </div>

          <div class="form-navigation">
            <button type="button" class="btn" id="cancel-verification">Cancelar</button>
            <button type="submit" class="btn btn-success" id="submit-verification">Finalizar Verifica√ß√£o</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Detalhes da Manuten√ß√£o -->
    <div class="form-overlay" id="detail-overlay">
      <div class="form-container">
        <div class="form-header">
          <h2 class="form-title">Detalhes da Manuten√ß√£o</h2>
          <button class="form-close" id="close-detail">√ó</button>
        </div>

        <div class="maintenance-detail" id="maintenance-detail-content">
          <!-- Conte√∫do ser√° preenchido via JavaScript -->
        </div>

        <div class="form-navigation">
          <button class="btn" id="close-detail-btn">Fechar</button>
          <button class="btn btn-success" id="verify-maintenance-btn">Verificar Manuten√ß√£o</button>
        </div>
      </div>
    </div>

    <!-- Notifica√ß√µes -->
    <div id="notification-container"></div>

    <!-- Bot√£o de Nova Manuten√ß√£o -->
    <div class="btn-new" id="new-maintenance">+</div>

    <div class="footer">
      <p>Sistema de Dupla Checagem de Manuten√ß√£o ¬© 2025 | √öltima atualiza√ß√£o: <span id="last-update">Carregando...</span></p>
      <p class="developer-credit">Desenvolvido por Warlison Abreu</p>
    </div>
  </div>

  <!-- Indicador de Loading -->
  <div id="global-loader" style="display: none;">
    <div class="loader-spinner"></div>
    <div id="global-loader-message">Carregando...</div>
  </div>

  <!-- ****** IN√çCIO DA SE√á√ÉO DE SCRIPTS ATUALIZADA ****** -->
<!-- JavaScript - Sistema de carregamento robusto -->
<script>
// Configura√ß√µes do sistema
const scriptConfig = {
  baseUrl: '', // URL base para os scripts, deixe vazio se estiverem na mesma pasta que o HTML
  scripts: [
    {name: 'api', path: 'js/api.js', required: true},
    {name: 'utilities', path: 'js/utilities.js', required: true},
    {name: 'dashboard', path: 'js/dashboard.js', depends: ['api', 'utilities']},
    {name: 'maintenance', path: 'js/maintenance.js', depends: ['api', 'utilities']},
    {name: 'verification', path: 'js/verification.js', depends: ['api', 'utilities']},
    {name: 'reports', path: 'js/reports.js', depends: ['api', 'utilities']},
    {name: 'main', path: 'js/main.js', depends: ['api', 'utilities']}
  ],
  maxRetries: 3,
  timeout: 15000 // Aumentado para 15 segundos
};

// Sistema de carregamento de scripts com retentativas
const ScriptLoader = {
  loadedScripts: {},
  pendingScripts: {},

  init: function() {
    console.log("Iniciando carregamento das depend√™ncias...");
    // Primeiro carregar as depend√™ncias essenciais
    this.loadCoreScripts();
  },

  loadCoreScripts: function() {
    // Identificar scripts essenciais
    const coreScripts = scriptConfig.scripts.filter(s => s.required);

    // Carregar scripts essenciais de forma sequencial para mais consist√™ncia
    this.loadScriptsSequentially(coreScripts, 0, () => {
      console.log("Depend√™ncias essenciais carregadas sequencialmente.");

      // Verificar se as flags foram definidas
      if (!window.API_LOADED) {
        console.warn("Flag window.API_LOADED n√£o definida em api.js!");
      }
      if (!window.UTILITIES_LOADED) {
        console.warn("Flag window.UTILITIES_LOADED n√£o definida em utilities.js!");
      }

      // Continue carregando os scripts restantes mesmo que as flags n√£o estejam definidas
      this.loadRemainingScripts();
    });
  },

  loadRemainingScripts: function() {
    // Filtrar scripts que n√£o s√£o essenciais
    const remainingScripts = scriptConfig.scripts.filter(s => !s.required);

    // Carregar scripts sequencialmente para garantir depend√™ncias
    console.log("Carregando scripts restantes...");
    this.loadScriptsSequentially(remainingScripts, 0, () => {
      console.log("Todos os scripts (essenciais e restantes) foram carregados.");
      this.initializeSystem();
    });
  },

  loadScriptsSequentially: function(scripts, index, onComplete) {
    if (index >= scripts.length) {
      if (typeof onComplete === 'function') {
        onComplete();
      }
      return;
    }

    const script = scripts[index];

    // Verificar depend√™ncias antes de tentar carregar
    if (script.depends && script.depends.length > 0) {
      const allDependenciesLoaded = script.depends.every(dep => this.loadedScripts[dep]);

      if (!allDependenciesLoaded) {
        console.warn(`Depend√™ncias para ${script.name} (${script.depends.join(', ')}) n√£o est√£o totalmente carregadas. Tentando carregar mesmo assim, mas pode causar erros.`);
      }
    }

    this.loadScript(script.name, script.path)
      .then(() => {
        this.loadScriptsSequentially(scripts, index + 1, onComplete);
      })
      .catch((error) => {
        console.error(`Erro ao carregar script ${script.name}:`, error);
        // Continua carregando os outros scripts
        this.loadScriptsSequentially(scripts, index + 1, onComplete);
      });
  },

  loadScript: function(name, path, retryCount = 0) {
    // Se o script j√° foi carregado, retorne imediatamente.
    if (this.loadedScripts[name]) {
      return Promise.resolve();
    }

    // Se o script j√° est√° sendo carregado (pendente), retorne a promise existente.
    if (this.pendingScripts[name]) {
      return this.pendingScripts[name];
    }

    const url = scriptConfig.baseUrl + path;
    console.log(`Iniciando carregamento de: ${name} (${url})`);

    // Criar nova promise para carregar o script
    const promise = new Promise((resolve, reject) => {
      const scriptElement = document.createElement('script');
      scriptElement.src = url;
      scriptElement.async = true;

      let timeoutId = null;

      // Fun√ß√£o para limpar recursos
      const cleanup = () => {
        clearTimeout(timeoutId);
        scriptElement.onload = null;
        scriptElement.onerror = null;
      };

      // Configurar timeout
      timeoutId = setTimeout(() => {
        console.error(`Timeout ao carregar ${name} (${url}) ap√≥s ${scriptConfig.timeout}ms`);
        scriptElement.remove();
        delete this.pendingScripts[name];

        if (retryCount < scriptConfig.maxRetries) {
          console.log(`Tentando carregar ${name} novamente (tentativa ${retryCount + 1}/${scriptConfig.maxRetries})...`);
          this.loadScript(name, path, retryCount + 1)
            .then(resolve)
            .catch(reject);
        } else {
          cleanup();
          reject(new Error(`Falha ao carregar ${name} ap√≥s ${scriptConfig.maxRetries} tentativas (timeout)`));
        }
      }, scriptConfig.timeout);

      // Evento de sucesso
      scriptElement.onload = () => {
        console.log(`Script ${name} (${path}) carregado com sucesso.`);
        cleanup();
        this.loadedScripts[name] = true;
        delete this.pendingScripts[name];
        resolve();
      };

      // Evento de erro
      scriptElement.onerror = (event) => {
        console.error(`Erro ao carregar ${name} (${url})`, event);
        scriptElement.remove();
        delete this.pendingScripts[name];

        if (retryCount < scriptConfig.maxRetries) {
          console.log(`Tentando carregar ${name} novamente (tentativa ${retryCount + 1}/${scriptConfig.maxRetries})...`);
          setTimeout(() => {
            this.loadScript(name, path, retryCount + 1)
              .then(resolve)
              .catch(reject);
          }, 500 * (retryCount + 1));
        } else {
          cleanup();
          reject(new Error(`Falha ao carregar ${name} (${url}) ap√≥s ${scriptConfig.maxRetries} tentativas`));
        }
      };

      // Adicionar ao body para iniciar o carregamento
      document.body.appendChild(scriptElement);
    });

    // Armazena a promise enquanto o script est√° carregando
    this.pendingScripts[name] = promise;
    return promise;
  },

  initializeSystem: function() {
    console.log("Tentando inicializar o sistema...");
    const loader = document.getElementById('global-loader');
    if (loader) loader.style.display = 'flex';

    try {
      // Tenta chamar a fun√ß√£o global de inicializa√ß√£o
      if (typeof window.initializeApp === 'function') {
        window.initializeApp();
        console.log("Sistema inicializado via window.initializeApp().");
      } else if (typeof initializeApp === 'function') { // Fallback
        initializeApp();
        console.log("Sistema inicializado via initializeApp().");
      } else {
        console.error("Fun√ß√£o de inicializa√ß√£o 'initializeApp' n√£o encontrada. A aplica√ß√£o pode n√£o funcionar corretamente.");
        // Tentar inicializar componentes individuais como fallback
        this.initializeComponentsFallback();
      }
    } catch (error) {
      console.error("Erro GERAL durante a inicializa√ß√£o do sistema:", error);
      this.showErrorMessage();
    } finally {
      setTimeout(() => {
        if (loader) loader.style.display = 'none';
      }, 200);
    }
  },

  initializeComponentsFallback: function() {
    console.warn("Tentando inicializar componentes individuais como fallback...");
    let initializedSomething = false;

    // Tenta inicializar componentes comuns
    if (typeof Dashboard !== 'undefined' && typeof Dashboard.initialize === 'function') {
      try {
        Dashboard.initialize();
        console.log("Dashboard inicializado (fallback).");
        initializedSomething = true;
      } catch (e) { console.error("Erro ao inicializar Dashboard (fallback):", e); }
    }

    if (typeof Maintenance !== 'undefined' && typeof Maintenance.initialize === 'function') {
      try {
        Maintenance.initialize();
        console.log("Maintenance inicializado (fallback).");
        initializedSomething = true;
      } catch (e) { console.error("Erro ao inicializar Maintenance (fallback):", e); }
    }

    if (typeof Verification !== 'undefined' && typeof Verification.initialize === 'function') {
      try {
        Verification.initialize();
        console.log("Verification inicializado (fallback).");
        initializedSomething = true;
      } catch (e) { console.error("Erro ao inicializar Verification (fallback):", e); }
    }

    if (typeof Reports !== 'undefined' && typeof Reports.initialize === 'function') {
      try {
        Reports.initialize();
        console.log("Reports inicializado (fallback).");
        initializedSomething = true;
      } catch (e) { console.error("Erro ao inicializar Reports (fallback):", e); }
    }

    if (!initializedSomething) {
      console.error("Nenhum componente p√¥de ser inicializado via fallback.");
      this.showErrorMessage();
    }
  },

  showErrorMessage: function() {
    // Garante que n√£o haja m√∫ltiplas mensagens de erro
    if (document.getElementById('script-load-error-message')) {
      return;
    }

    // Criar mensagem de erro vis√≠vel
    const errorDiv = document.createElement('div');
    errorDiv.id = 'script-load-error-message';
    errorDiv.style.cssText = `
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #ffebe6;
      color: #bf2600;
      padding: 25px;
      border: 1px solid #ffbdad;
      border-radius: 8px;
      box-shadow: 0 6px 16px rgba(0,0,0,0.15);
      z-index: 10000;
      max-width: 90%;
      width: 450px;
      text-align: center;
      font-family: sans-serif;
    `;

    errorDiv.innerHTML = `
      <h2 style="color: #bf2600; margin-top: 0; margin-bottom: 15px; font-size: 1.3em;">Erro ao Carregar o Sistema</h2>
      <p style="margin-bottom: 20px; line-height: 1.5; font-size: 0.95em;">Ocorreu um problema ao carregar alguns componentes essenciais da aplica√ß√£o. Por favor, tente as seguintes a√ß√µes:</p>
      <ul style="text-align: left; margin: 0 auto 20px auto; padding-left: 20px; max-width: 300px; font-size: 0.9em;">
        <li style="margin-bottom: 8px;">Atualize a p√°gina (F5 ou Ctrl+R).</li>
        <li style="margin-bottom: 8px;">Limpe o cache do seu navegador.</li>
        <li style="margin-bottom: 8px;">Verifique sua conex√£o com a internet.</li>
        <li>Tente usar um navegador diferente (Chrome, Firefox, Edge).</li>
      </ul>
      <button id="retry-load-btn" style="
        background-color: #de350b;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-weight: 600;
        font-size: 1em;
        transition: background-color 0.2s ease;
      ">Tentar Carregar Novamente</button>
      <p style="margin-top: 20px; font-size: 0.8em; color: #5e6c84;">
        Se o problema persistir ap√≥s tentar as solu√ß√µes acima, por favor, contate o suporte t√©cnico.
      </p>
    `;

    document.body.appendChild(errorDiv);

    // Adicionar evento ao bot√£o para recarregar a p√°gina
    const retryButton = document.getElementById('retry-load-btn');
    if(retryButton) {
      retryButton.addEventListener('click', function() {
        errorDiv.remove();
        location.reload();
      });
      retryButton.onmouseover = () => retryButton.style.backgroundColor = '#bf2600';
      retryButton.onmouseout = () => retryButton.style.backgroundColor = '#de350b';
    }

    const loader = document.getElementById('global-loader');
    if (loader) loader.style.display = 'none';
  }
};

// Iniciar carregamento quando o DOM estiver pronto
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', function() {
    console.log("DOM carregado. Iniciando ScriptLoader.");
    ScriptLoader.init();
  });
} else {
  console.log("DOM j√° estava carregado. Iniciando ScriptLoader.");
  ScriptLoader.init();
}
</script>
<!-- ****** FIM DA SE√á√ÉO DE SCRIPTS ATUALIZADA ****** -->

</body>
</html>
